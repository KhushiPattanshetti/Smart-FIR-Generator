<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Charge Sheet - {{ fir.fir_number }}</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; }
    .header { text-align: center; margin-bottom: 20px; }
    .header h3 { margin-bottom: 5px; }
    .header h5 { margin-top: 0; }
    .section { margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
    th, td { border: 1px solid #000; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .signature-section { margin-top: 50px; }
    .signature { border-top: 1px solid #000; width: 200px; display: inline-block; padding-top: 5px; }
  </style>
</head>
<body>
  <div class="header">
    <h3>OFFICIAL CHARGE SHEET</h3>
    <h5>{{ fir.station.name }} Police Station</h5>
    <p>FIR No: {{ fir.fir_number }}</p>
  </div>
  
  <div class="section">
    <h4>1. Case Details</h4>
    <table>
      <tr>
        <td><strong>Complainant:</strong></td>
        <td>{{ fir.complainant_name }}</td>
        <td><strong>Incident Date:</strong></td>
        <td>{{ fir.incident_date|date:"d/m/Y" }}</td>
      </tr>
      <tr>
        <td><strong>Location:</strong></td>
        <td colspan="3">{{ fir.incident_location }}</td>
      </tr>
      <tr>
        <td><strong>Investigating Officer:</strong></td>
        <td>{{ fir.police_officer.username }}</td>
        <td><strong>Station:</strong></td>
        <td>{{ fir.station.name }}</td>
      </tr>
    </table>
    <p><strong>Brief Description:</strong> {{ fir.incident_description }}</p>
  </div>
  
  <div class="section">
    <h4>2. Charges</h4>
    <table>
      <thead>
        <tr>
          <th>IPC Section</th>
          <th>Description</th>
          <th>Act</th>
        </tr>
      </thead>
      <tbody>
        {% for suggestion in legal_suggestions %}
        <tr>
          <td>{{ suggestion.ipc_section }}</td>
          <td>{{ suggestion.description }}</td>
          <td>{{ suggestion.act_name }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  <div class="section">
    <h4>3. Evidence</h4>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for item in evidence %}
        <tr>
          <td>{{ item.get_evidence_type_display }}</td>
          <td>{{ item.description }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="2">No evidence recorded</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  <div class="section">
    <h4>4. Witnesses</h4>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Contact</th>
          <th>Statement Summary</th>
        </tr>
      </thead>
      <tbody>
        {% for witness in witnesses %}
        <tr>
          <td>{{ witness.name }}</td>
          <td>{{ witness.contact }}</td>
          <td>{{ witness.statement|truncatechars:100 }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3">No witnesses recorded</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  <div class="signature-section">
    <div style="float: left; width: 40%;">
      <div class="signature">Investigating Officer</div>
    </div>
    <div style="float: right; width: 40%; text-align: right;">
      <div class="signature">Station In-Charge</div>
    </div>
    <div style="clear: both;"></div>
  </div>
</body>
</html>